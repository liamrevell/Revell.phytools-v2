@BOOK{Felsenstein2004-ab,
  title     = "Inferring phylogenies",
  author    = "Felsenstein, Joseph",
  publisher = "Sinauer associates",
  year      =  2004,
  address   = "Sunderland, MA",
  keywords  = "Rbook"
}

@BOOK{Harvey1991-oj,
  title     = "The Comparative Method in Evolutionary Biology",
  author    = "Harvey, P H and Pagel, M D",
  abstract  = "The comparative approach in evolutionary biology involves
               looking for correlations in characters between different members
               of a taxon. Using each species as an independent data point for
               statistical purposes is not valid, since species are often not
               independent ...",
  publisher = "Oxford University Press",
  series    = "Oxford Series in Ecology and Evolution",
  year      =  1991,
  keywords  = "pcmBook;harmon;NRT-CTN;oopsie;Rbook"
}

@ARTICLE{Revell2012,
  title     = "phytools: an {R} package for phylogenetic comparative biology
               (and other things)",
  author    = "Revell, Liam J",
  journal   = "Methods Ecol. Evol.",
  publisher = "Wiley Online Library",
  volume    =  3,
  number    =  2,
  pages     = "217--223",
  year      =  2012,
  keywords  = "oopsie;Rbook"
}

@Manual{Becker2022,
  title = {maps: Draw Geographical Maps},
  author = {Richard A. Becker and Allan R. Wilks and Ray Brownrigg and Thomas P. Minka and Alex Deckmyn},
  year = {2022},
  note = {R package version 3.4.1},
  url = {https://CRAN.R-project.org/package=maps},
}

@Manual{Qiu2020,
  title = {clusterGeneration: Random Cluster Generation (with Specified Degree of Separation)},
  author = {Weiliang Qiu and Harry Joe.},
  year = {2020},
  note = {R package version 1.3.7},
  url = {https://CRAN.R-project.org/package=clusterGeneration},
}

@Article{Plummer2006,
  title = {CODA: Convergence Diagnosis and Output Analysis for MCMC},
  author = {Martyn Plummer and Nicky Best and Kate Cowles and Karen Vines},
  journal = {R News},
  year = {2006},
  volume = {6},
  number = {1},
  pages = {7--11},
  url = {https://journal.r-project.org/archive/},
  pdf = {https://www.r-project.org/doc/Rnews/Rnews_2006-1.pdf},
}

@Manual{Chasalow2012,
  title = {combinat: combinatorics utilities},
  author = {Scott Chasalow},
  year = {2012},
  note = {R package version 0.0-8},
  url = {https://CRAN.R-project.org/package=combinat},
}

@Manual{Microsoft2022-a,
  title = {doParallel: Foreach Parallel Adaptor for the 'parallel' Package},
  author = {Microsoft Corporation and Steve Weston},
  year = {2022},
  note = {R package version 1.0.17},
  url = {https://CRAN.R-project.org/package=doParallel},
}

@Manual{Maechler2023,
  title = {expm: Matrix Exponential, Log, 'etc'},
  author = {Martin Maechler and Christophe Dutang and Vincent Goulet},
  year = {2023},
  note = {R package version 0.999-7},
  url = {https://CRAN.R-project.org/package=expm},
}

@Manual{Microsoft2022-b,
  title = {foreach: Provides Foreach Looping Construct},
  author = {{Microsoft} and Steve Weston},
  year = {2022},
  note = {R package version 1.5.2},
  url = {https://CRAN.R-project.org/package=foreach},
}

@Book{Venables2002,
  title = {Modern Applied Statistics with S},
  author = {W. N. Venables and B. D. Ripley},
  publisher = {Springer},
  edition = {Fourth},
  address = {New York},
  year = {2002},
  note = {ISBN 0-387-95457-0},
  url = {https://www.stats.ox.ac.uk/pub/MASS4/},
}
  
@Manual{Azzalini2022,
  title = {The {R} package \texttt{mnormt}: The multivariate normal and $t$ distributions (version 2.1.1)},
  author = {Adelchi Azzalini and Alan Genz},
  year = {2022},
  url = {http://azzalini.stat.unipd.it/SW/Pkg-mnormt/},
}

@Manual{Pinheiro2022,
  title = {nlme: Linear and Nonlinear Mixed Effects Models},
  author = {José Pinheiro and Douglas Bates and {R Core Team}},
  year = {2022},
  note = {R package version 3.1-160},
  url = {https://CRAN.R-project.org/package=nlme},
}

@Book{Pinheiro2000,
  title = {Mixed-Effects Models in S and S-PLUS},
  author = {José C. Pinheiro and Douglas M. Bates},
  year = {2000},
  publisher = {Springer},
  address = {New York},
  doi = {10.1007/b98882},
}

@Manual{Gilbert2019,
  title = {numDeriv: Accurate Numerical Derivatives},
  author = {Paul Gilbert and Ravi Varadhan},
  year = {2019},
  note = {R package version 2016.8-1.1},
  url = {https://CRAN.R-project.org/package=numDeriv},
}

@Article{Gerber2019,
  title = {optimParallel: An R Package Providing a Parallel Version of the L-BFGS-B Optimization Method},
  author = {Florian Gerber and Reinhard Furrer},
  journal = {The R Journal},
  year = {2019},
  volume = {11},
  number = {1},
  pages = {352--358},
  url = {https://doi.org/10.32614/RJ-2019-030},
  doi = {10.32614/RJ-2019-030},
}

@Article{Lemon2006,
  year = {2006},
  title = {Plotrix: a package in the red light district of R},
  journal = {R-News},
  volume = {6},
  number = {4},
  pages = {8-12},
  author = {Lemon J},
}

@Article{Ligges2003,
  title = {Scatterplot3d - an R Package for Visualizing Multivariate Data},
  author = {Uwe Ligges and Martin M{\"a}chler},
  journal = {Journal of Statistical Software},
  year = {2003},
  pages = {1--20},
  number = {11},
  volume = {8},
  doi = {10.18637/jss.v008.i11},
}

@BOOK{Nunn2011-kr,
  title     = "The Comparative Approach in Evolutionary Anthropology and
               Biology",
  author    = "Nunn, Charles L",
  publisher = "University of Chicago Press",
  month     =  nov,
  year      =  2011,
  keywords  = "Rbook",
  language  = "en"
}

@BOOK{Harmon2019-on,
  title     = "Phylogenetic comparative methods: learning from trees",
  author    = "Harmon, Luke J",
  abstract  = "Evolution is happening all around us. In many cases--lately, due
               to technological advances in molecular biology--scientists can
               now describe the evolutionary process in exquisite detail. For
               example, we know exactly which genes change in frequency from
               one generation …",
  publisher = "Ecoevorxiv",
  year      =  2019,
  keywords  = "arbor products;oopsie;Rbook"
}

@BOOK{Revell2022-book,
  title     = "Phylogenetic Comparative Methods in {R}",
  author    = "Revell, Liam J and Harmon, Luke J",
  publisher = "Princeton University Press",
  month     =  sep,
  year      =  2022,
  address   = "Princeton, NJ"
}


@ARTICLE{Felsenstein1985-bt,
  title    = "Phylogenies and the Comparative Method",
  author   = "Felsenstein, Joseph",
  abstract = "Comparative studies of the relationship between two phenotypes,
              or between a phenotype and an environment, are frequently carried
              out by invalid statistical methods. Most regression, correlation,
              and contingency table methods, including nonparametric methods,
              assume that the points are drawn independently from a common
              distribution. When species are taken from a branching phylogeny,
              they are manifestly nonindependent. Use of a statistical method
              that assumes independence will cause overstatement of the
              significance in hypothesis tests. Some illustrative examples of
              these phenomena have been given, and limitations of previous
              proposals of ways to correct for the nonindependence have been
              discussed. A method of correcting for the phylogeny has been
              proposed. It requires that we know both the tree topology and the
              branch lengths, and that we be willing to allow the characters to
              be modeled by Brownian motion on a linear scale. Given these
              conditions, the phylogeny specifies a set of contrasts among
              species, contrasts that are statistically independent and can be
              used in regression or correlation studies. The considerable
              barriers to making practical use of this technique have been
              discussed.",
  journal  = "Am. Nat.",
  volume   =  125,
  number   =  1,
  pages    = "1--15",
  year     =  1985,
  keywords = "pcmBook;NRT-CTN;oopsie;Rbook"
}

@ARTICLE{Huey2019-zv,
  title     = "Revisiting a key innovation in evolutionary biology:
               Felsenstein's ``phylogenies and the comparative method''",
  author    = "Huey, Raymond B and Garland, Jr, Theodore and Turelli, Michael",
  journal   = "Am. Nat.",
  publisher = "The University of Chicago Press Chicago, IL",
  volume    =  193,
  number    =  6,
  pages     = "755--772",
  year      =  2019,
  keywords  = "Rbook"
}

 @Manual{Rbase2022,
   title = {R: A Language and Environment for Statistical Computing},
   author = {{R Core Team}},
   organization = {R Foundation for Statistical Computing},
   address = {Vienna, Austria},
   year = {2022},
   url = {https://www.R-project.org/},
 }
 
 @ARTICLE{Paradis2004-xk,
  title     = "{APE}: Analyses of Phylogenetics and Evolution in {R} language",
  author    = "Paradis, Emmanuel and Claude, Julien and Strimmer, Korbinian",
  abstract  = "UNLABELLED: Analysis of Phylogenetics and Evolution (APE) is a
               package written in the R language for use in molecular evolution
               and phylogenetics. APE provides both utility functions for
               reading and writing data and manipulating phylogenetic trees, as
               well as several advanced methods for phylogenetic and
               evolutionary analysis (e.g. comparative and population genetic
               methods). APE takes advantage of the many R functions for
               statistics and graphics, and also provides a flexible framework
               for developing and implementing further statistical methods for
               the analysis of evolutionary processes. AVAILABILITY: The
               program is free and available from the official R package
               archive at
               http://cran.r-project.org/src/contrib/PACKAGES.html\#ape. APE is
               licensed under the GNU General Public License.",
  journal   = "Bioinformatics",
  publisher = "academic.oup.com",
  volume    =  20,
  number    =  2,
  pages     = "289--290",
  month     =  jan,
  year      =  2004,
  keywords  = "pcmBook;NRT-CTN;oopsie;Rbook",
  language  = "en"
}

@ARTICLE{Popescu2012-ui,
  title     = "ape 3.0: New tools for distance-based phylogenetics and
               evolutionary analysis in {R}",
  author    = "Popescu, Andrei-Alin and Huber, Katharina T and Paradis,
               Emmanuel",
  abstract  = "UNLABELLED: Reflecting its continuously increasing versatility
               and functionality, the popularity of the ape (analysis of
               phylogenetics and evolution) software package has grown steadily
               over the years. Among its features, it has a strong
               distance-based component allowing the user to compute distances
               from aligned DNA sequences based on most methods from the
               literature and also build phylogenetic trees from them. However,
               even data generated with modern genomic approaches can fail to
               give rise to sufficiently reliable distance estimates. One way
               to overcome this problem is to exclude such estimates from data
               analysis giving rise to an incomplete distance data set (as
               opposed to a complete one). So far their analysis has been out
               of reach for ape. To remedy this, we have incorporated into ape
               several methods from the literature for phylogenetic inference
               from incomplete distance matrices. In addition, we have also
               extended ape's repertoire for phylogenetic inference from
               complete distances, added a new object class to efficiently
               encode sets of splits of taxa, and extended the functionality of
               some of its existing functions. AVAILABILITY: ape is distributed
               through the Comprehensive R Archive Network:
               http://cran.r-project.org/web/packages/ape/index.html Further
               information may be found at http://ape.mpl.ird.fr/pegas/",
  journal   = "Bioinformatics",
  publisher = "Oxford University Press (OUP)",
  volume    =  28,
  number    =  11,
  pages     = "1536--1537",
  month     =  jun,
  year      =  2012,
  language  = "en"
}

@ARTICLE{Paradis2019-zp,
  title     = "ape 5.0: an environment for modern phylogenetics and
               evolutionary analyses in {R}",
  author    = "Paradis, Emmanuel and Schliep, Klaus",
  journal   = "Bioinformatics",
  publisher = "Oxford University Press",
  volume    =  35,
  number    =  3,
  pages     = "526--528",
  year      =  2019,
  keywords  = "oopsie;Rbook"
}

@ARTICLE{Harmon2008-id,
  title     = "{GEIGER}: investigating evolutionary radiations",
  author    = "Luke J. Harmon and Jason T. Weir and Chad D. Brock and Richard E. Glor and Wendell Challenger",
  journal   = "Bioinformatics",
  publisher = "Oxford University Press",
  volume    =  24,
  number    =  1,
  pages     = "129--131",
  year      =  2008,
  keywords  = "citations.bib;NRT-CTN;oopsie;Rbook"
}

@ARTICLE{Pennell2014-mo,
  title     = "geiger v2. 0: an expanded suite of methods for fitting
               macroevolutionary models to phylogenetic trees",
  author    = "Pennell, Matthew W and Eastman, Jonathan M and Slater, Graham J
               and Brown, Joseph W and Uyeda, Josef C and FitzJohn, Richard G
               and Alfaro, Michael E and Harmon, Luke J",
  journal   = "Bioinformatics",
  publisher = "Oxford University Press",
  volume    =  30,
  number    =  15,
  pages     = "2216--2218",
  year      =  2014,
  keywords  = "citations.txt;arbor
               products;citations.bib;harmon;NRT-CTN;oopsie;Rbook"
}

@ARTICLE{Schliep2011-my,
  title    = "phangorn: phylogenetic analysis in {R}",
  author   = "Schliep, Klaus Peter",
  abstract = "SUMMARY: phangorn is a package for phylogenetic reconstruction
              and analysis in the R language. Previously it was only possible
              to estimate phylogenetic trees with distance methods in R.
              phangorn, now offers the possibility of reconstructing
              phylogenies with distance based methods, maximum parsimony or
              maximum likelihood (ML) and performing Hadamard conjugation.
              Extending the general ML framework, this package provides the
              possibility of estimating mixture and partition models.
              Furthermore, phangorn offers several functions for comparing
              trees, phylogenetic models or splits, simulating character data
              and performing congruence analyses. AVAILABILITY: phangorn can be
              obtained through the CRAN homepage
              http://cran.r-project.org/web/packages/phangorn/index.html.
              phangorn is licensed under GPL 2.",
  journal  = "Bioinformatics",
  volume   =  27,
  number   =  4,
  pages    = "592--593",
  month    =  feb,
  year     =  2011,
  keywords = "oopsie;Rbook",
  language = "en"
}

@ARTICLE{Lewis2001-bu,
  title    = "A Likelihood Approach to Estimating Phylogeny from Discrete
              Morphological Character Data",
  author   = "Lewis, Paul O",
  abstract = "Evolutionary biologists have adopted simple likelihood models for
              purposes of estimating ancestral states and evaluating character
              independence on specified phylogenies; however, for purposes of
              estimating phylogenies by using discrete morphological data,
              maximum parsimony remains the only option. This paper explores
              the possibility of using standard, well-behaved Markov models for
              estimating morphological phylogenies (including branch lengths)
              under the likelihood criterion. An important modification of
              standard Markov models involves making the likelihood conditional
              on characters being variable, because constant characters are
              absent in morphological data sets. Without this modification,
              branch lengths are often overestimated, resulting in potentially
              serious biases in tree topology selection. Several new avenues of
              research are opened by an explicitly model-based approach to
              phylogenetic analysis of discrete morphological data, including
              combined-data likelihood analyses (morphology + sequence data),
              likelihood ratio tests, and Bayesian analyses.",
  journal  = "Syst. Biol.",
  volume   =  50,
  number   =  6,
  pages    = "913--925",
  month    =  nov,
  year     =  2001,
  keywords = "pcmBook;NRT-CTN;oopsie;Rbook"
}

@ARTICLE{Pagel1994-ui,
  title     = "Detecting correlated evolution on phylogenies: a general method
               for the comparative analysis of discrete characters",
  author    = "Pagel, Mark",
  abstract  = "I present a new statistical method for analysing the
               relationship between two discrete characters that are measured
               across a group of hierarchically evolved species or populations.
               The method assesses whether a pattern of association across the
               group is evidence for correlated evolutionary change in the two
               characters. The method takes into account information on the
               lengths of the branches of phylogenetic trees, develops
               estimates of the rates of change of the discrete characters, and
               tests the hypothesis of correlated evolution without relying
               upon reconstructions of the ancestral character states. A
               likelihood ratio test statistic is used to discriminate between
               two models that are fitted to the data: one allowing only for
               independent evolution of the two characters, the other allowing
               for correlated evolution. Tests of specific directional
               hypotheses can also be made. The method is illustrated with an
               application to the Hominoidea.",
  journal   = "Proc. R. Soc. Lond. B Biol. Sci.",
  publisher = "The Royal Society",
  volume    =  255,
  number    =  1342,
  pages     = "37--45",
  month     =  jan,
  year      =  1994,
  keywords  = "pcmBook;NRT-CTN;Rbook",
  language  = "en"
}

@ARTICLE{Huelsenbeck2003-iq,
  title    = "Stochastic mapping of morphological characters",
  author   = "Huelsenbeck, John P and Nielsen, Rasmus and Bollback, Jonathan P",
  abstract = "Many questions in evolutionary biology are best addressed by
              comparing traits in different species. Often such studies involve
              mapping characters on phylogenetic trees. Mapping characters on
              trees allows the nature, number, and timing of the
              transformations to be identified. The parsimony method is the
              only method available for mapping morphological characters on
              phylogenies. Although the parsimony method often makes reasonable
              reconstructions of the history of a character, it has a number of
              limitations. These limitations include the inability to consider
              more than a single change along a branch on a tree and the
              uncoupling of evolutionary time from amount of character change.
              We extended a method described by Nielsen (2002, Syst. Biol.
              51:729-739) to the mapping of morphological characters under
              continuous-time Markov models and demonstrate here the utility of
              the method for mapping characters on trees and for identifying
              character correlation.",
  journal  = "Syst. Biol.",
  volume   =  52,
  number   =  2,
  pages    = "131--158",
  month    =  apr,
  year     =  2003,
  keywords = "Rbook",
  language = "en"
}

@ARTICLE{Felsenstein2005-am,
  title    = "Using the quantitative genetic threshold model for inferences
              between and within species",
  author   = "Felsenstein, Joseph",
  abstract = "Sewall Wright's threshold model has been used in modelling
              discrete traits that may have a continuous trait underlying them,
              but it has proven difficult to make efficient statistical
              inferences with it. The availability of Markov chain Monte Carlo
              (MCMC) methods makes possible likelihood and Bayesian inference
              using this model. This paper discusses prospects for the use of
              the threshold model in morphological systematics to model the
              evolution of discrete all-or-none traits. There the threshold
              model has the advantage over 0/1 Markov process models in that it
              not only accommodates polymorphism within species, but can also
              allow for correlated evolution of traits with far fewer
              parameters that need to be inferred. The MCMC importance sampling
              methods needed to evaluate likelihood ratios for the threshold
              model are introduced and described in some detail.",
  journal  = "Philos. Trans. R. Soc. Lond. B Biol. Sci.",
  volume   =  360,
  number   =  1459,
  pages    = "1427--1434",
  month    =  jul,
  year     =  2005,
  keywords = "pcmBook;NRT-CTN;Rbook",
  language = "en"
}

@ARTICLE{Revell2014-ba,
  title    = "Ancestral character estimation under the threshold model from
              quantitative genetics",
  author   = "Revell, Liam J",
  abstract = "Evolutionary biology is a study of life's history on Earth. In
              researching this history, biologists are often interested in
              attempting to reconstruct phenotypes for the long extinct
              ancestors of living species. Various methods have been developed
              to do this on a phylogeny from the data for extant taxa. In the
              present article, I introduce a new approach for ancestral
              character estimation for discretely valued traits. This approach
              is based on the threshold model from evolutionary quantitative
              genetics. Under the threshold model, the value exhibited by an
              individual or species for a discrete character is determined by
              an underlying, unobserved continuous trait called ``liability.''
              In this new method for ancestral state reconstruction, I use
              Bayesian Markov chain Monte Carlo (MCMC) to sample the
              liabilities of ancestral and tip species, and the relative
              positions of two or more thresholds, from their joint posterior
              probability distribution. Using data simulated under the model, I
              find that the method has very good performance in ancestral
              character estimation. Use of the threshold model for ancestral
              state reconstruction relies on a priori specification of the
              order of the discrete character states along the liability axis.
              I test the use of a Bayesian MCMC information theoretic criterion
              based approach to choose among different hypothesized orderings
              for the discrete character. Finally, I apply the method to the
              evolution of feeding mode in centrarchid fishes.",
  journal  = "Evolution",
  volume   =  68,
  number   =  3,
  pages    = "743--759",
  month    =  mar,
  year     =  2014,
  keywords = "Bayesian; Centrarchidae; Markov chain Monte Carlo; comparative
              method; deviance information criterion; interspecific data;
              phylogenetic tree;pcmBook;NRT-CTN;Rbook",
  language = "en"
}

@ARTICLE{Beaulieu2013-zo,
  title    = "Identifying hidden rate changes in the evolution of a binary
              morphological character: the evolution of plant habit in
              campanulid angiosperms",
  author   = "Beaulieu, Jeremy M and O'Meara, Brian C and Donoghue, Michael J",
  abstract = "The growth of phylogenetic trees in scope and in size is
              promising from the standpoint of understanding a wide variety of
              evolutionary patterns and processes. With trees comprised of
              larger, older, and globally distributed clades, it is likely that
              the lability of a binary character will differ significantly
              among lineages, which could lead to errors in estimating
              transition rates and the associated inference of ancestral
              states. Here we develop and implement a new method for
              identifying different rates of evolution in a binary character
              along different branches of a phylogeny. We illustrate this
              approach by exploring the evolution of growth habit in
              Campanulidae, a flowering plant clade containing some 35,000
              species. The distribution of woody versus herbaceous species
              calls into question the use of traditional models of binary
              character evolution. The recognition and accommodation of changes
              in the rate of growth form evolution in different lineages
              demonstrates, for the first time, a robust picture of growth form
              evolution across a very large, very old, and very widespread
              flowering plant clade.",
  journal  = "Syst. Biol.",
  volume   =  62,
  number   =  5,
  pages    = "725--737",
  month    =  sep,
  year     =  2013,
  keywords = "pcmBook;NRT-CTN;Rbook",
  language = "en"
}

@ARTICLE{Revell2018-kr,
  title     = "Comparing evolutionary rates between trees, clades and traits",
  author    = "Revell, Liam J and Gonzalez-Valenzuela, Laura E and Alfonso,
               Alejandro and Castellanos-Garcia, Luisa A and Guarnizo, Carlos E
               and Crawford, Andrew J",
  abstract  = "Abstract The tempo of evolutionary change through time is among
               the most heavily studied dimensions of macroevolution using
               phylogenies. Here, we present a simple, likelihood-based method
               for comparing the rate of phenotypic evolution for continuous
               characters between trees. Our method is derived from a previous
               approach published by Brian O'Meara and colleagues in 2006. We
               examine the statistical performance of the method and find that
               it suffers from the typical downward bias expected for maximum
               likelihood estimates of the variance, but only for very small
               trees. We find that evolutionary rates are estimated with
               minimal bias for trees of even relatively modest size. We also
               find that type I error rates based on a likelihood-ratio test
               are minimally elevated above the nominal level, even for small
               phylogenies. The type I error rate can be reduced to a level at
               or below its nominal value by substituting a test-statistic
               distribution obtained via simulation under the null hypothesis
               of no difference in evolutionary rate among trees. We discuss
               the consequences of failing to account for uncertainty in the
               estimation of species means or in the phylogeny, and describe
               strategies for taking this uncertainty into consideration during
               estimation. We also identify how our approach is related to
               previous methods for comparing the rate of evolution among
               different clades of a single tree or between different
               phenotypic traits. Finally, we describe how the method can be
               applied to different evolutionary models and to discrete
               characters?options that are already implemented in software.
               Evolutionary biologists continue to be intrigued by changes in
               the tempo of phenotypic evolution across the tree of life. The
               method described herein should be useful for contexts in which
               changes in the evolutionary rate or process between two or more
               clades of distant or unknown relationship are of interest.",
  journal   = "Methods Ecol. Evol.",
  publisher = "Wiley Online Library",
  volume    =  9,
  number    =  4,
  pages     = "994--1005",
  month     =  apr,
  year      =  2018,
  keywords  = "Rbook"
}

@ARTICLE{Revell2009-bo,
  title    = "Phylogenetic analysis of the evolutionary correlation using
              likelihood",
  author   = "Revell, Liam J and Collar, David C",
  abstract = "Many evolutionary processes can lead to a change in the
              correlation between continuous characters over time or on
              different branches of a phylogenetic tree. Shifts in genetic or
              functional constraint, in the selective regime, or in some
              combination thereof can influence both the evolution of
              continuous traits and their relation to each other. These changes
              can often be mapped on a phylogenetic tree to examine their
              influence on multivariate phenotypic diversification. We propose
              a new likelihood method to fit multiple evolutionary rate
              matrices (also called evolutionary variance-covariance matrices)
              to species data for two or more continuous characters and a
              phylogeny. The evolutionary rate matrix is a matrix containing
              the evolutionary rates for individual characters on its diagonal,
              and the covariances between characters (of which the evolutionary
              correlations are a function) elsewhere. To illustrate our
              approach, we apply the method to an empirical dataset consisting
              of two features of feeding morphology sampled from 28 centrarchid
              fish species, as well as to data generated via phylogenetic
              numerical simulations. We find that the method has appropriate
              type I error, power, and parameter estimation. The approach
              presented herein is the first to allow for the explicit testing
              of how and when the evolutionary covariances between characters
              have changed in the history of a group.",
  journal  = "Evolution",
  volume   =  63,
  number   =  4,
  pages    = "1090--1100",
  month    =  apr,
  year     =  2009,
  keywords = "Rbook",
  language = "en"
}

@ARTICLE{Felsenstein2012-mi,
  title    = "A comparative method for both discrete and continuous characters
              using the threshold model",
  author   = "Felsenstein, Joseph",
  abstract = "The threshold model developed by Sewall Wright in 1934 can be
              used to model the evolution of two-state discrete characters
              along a phylogeny. The model assumes that there is a quantitative
              character, called liability, that is unobserved and that
              determines the discrete character according to whether the
              liability exceeds a threshold value. A Markov chain Monte Carlo
              algorithm is used to infer the evolutionary covariances of the
              liabilities for discrete characters, sampling liability values
              consistent with the phylogeny and with the observed data. The
              same approach can also be used for continuous characters by
              assuming that the tip species have values that have been
              observed. In this way, one can make a comparative-methods
              analysis that combines both discrete and continuous characters.
              Simulations are presented showing that the covariances of the
              liabilities are successfully estimated, although precision can be
              achieved only by using a large number of species, and we must
              always worry whether the covariances and the model apply
              throughout the group. An advantage of the threshold model is that
              the model can be straightforwardly extended to accommodate
              within-species phenotypic variation and allows an interface with
              quantitative-genetics models.",
  journal  = "Am. Nat.",
  volume   =  179,
  number   =  2,
  pages    = "145--156",
  month    =  feb,
  year     =  2012,
  keywords = "pcmBook;NRT-CTN;Rbook",
  language = "en"
}

@Manual{Garnier2022,
   title = {{viridis} - Colorblind-Friendly Color Maps for R},
   author = {{Garnier} and {Simon} and {Ross} and {Noam} and {Rudis} and {Robert} and {Camargo} and Antônio Pedro and {Sciaini} and {Marco} and {Scherer} and {Cédric}},
   year = {2022},
   note = {R package version 0.4.1},
   url = {https://sjmgarnier.github.io/viridis/},
   doi = {10.5281/zenodo.4679424},
   doi = {10.5281/zenodo.4679424},
}
  
@ARTICLE{Revell2013-ij,
  title     = "Two new graphical methods for mapping trait evolution on
               phylogenies",
  author    = "Revell, Liam J",
  journal   = "Methods Ecol. Evol.",
  publisher = "Wiley",
  volume    =  4,
  number    =  8,
  pages     = "754--759",
  month     =  aug,
  year      =  2013,
  language  = "en"
}

@article{Halali2020,
  doi = {10.1111/ele.13626},
  url = {https://doi.org/10.1111/ele.13626},
  year = {2020},
  month = oct,
  publisher = {Wiley},
  volume = {24},
  number = {1},
  pages = {102--112},
  author = {Sridhar Halali and Erik Bergen and Casper J. Breuker and Paul M. Brakefield and Oskar Brattstr\"{o}m},
  editor = {Kavita Isvaran},
  title = {Seasonal environments drive convergent evolution of a faster pace-of-life in tropical butterflies},
  journal = {Ecology Letters}
}

@ARTICLE{Pagel1999-ic,
  title    = "Inferring the historical patterns of biological evolution",
  author   = "Pagel, M",
  abstract = "Phylogenetic trees describe the pattern of descent amongst a
              group of species. With the rapid accumulation of DNA sequence
              data, more and more phylogenies are being constructed based upon
              sequence comparisons. The combination of these phylogenies with
              powerful new statistical approaches for the analysis of
              biological evolution is challenging widely held beliefs about the
              history and evolution of life on Earth.",
  journal  = "Nature",
  volume   =  401,
  number   =  6756,
  pages    = "877--884",
  month    =  oct,
  year     =  1999,
  keywords = "pcmBook;NRT-CTN;oopsie;Rbook",
  language = "en"
}

@ARTICLE{Blomberg2003-as,
  title    = "Testing for phylogenetic signal in comparative data: behavioral
              traits are more labile",
  author   = "Blomberg, Simon P and Garland, Jr, Theodore and Ives, Anthony R",
  abstract = "The primary rationale for the use of phylogenetically based
              statistical methods is that phylogenetic signal, the tendency for
              related species to resemble each other, is ubiquitous. Whether
              this assertion is true for a given trait in a given lineage is an
              empirical question, but general tools for detecting and
              quantifying phylogenetic signal are inadequately developed. We
              present new methods for continuous-valued characters that can be
              implemented with either phylogenetically independent contrasts or
              generalized least-squares models. First, a simple randomization
              procedure allows one to test the null hypothesis of no pattern of
              similarity among relatives. The test demonstrates correct Type I
              error rate at a nominal alpha = 0.05 and good power (0.8) for
              simulated datasets with 20 or more species. Second, we derive a
              descriptive statistic, K, which allows valid comparisons of the
              amount of phylogenetic signal across traits and trees. Third, we
              provide two biologically motivated branch-length transformations,
              one based on the Ornstein-Uhlenbeck (OU) model of stabilizing
              selection, the other based on a new model in which character
              evolution can accelerate or decelerate (ACDC) in rate (e.g., as
              may occur during or after an adaptive radiation). Maximum
              likelihood estimation of the OU (d) and ACDC (g) parameters can
              serve as tests for phylogenetic signal because an estimate of d
              or g near zero implies that a phylogeny with little hierarchical
              structure (a star) offers a good fit to the data. Transformations
              that improve the fit of a tree to comparative data will increase
              power to detect phylogenetic signal and may also be preferable
              for further comparative analyses, such as of correlated character
              evolution. Application of the methods to data from the literature
              revealed that, for trees with 20 or more species, 92\% of traits
              exhibited significant phylogenetic signal (randomization test),
              including behavioral and ecological ones that are thought to be
              relatively evolutionarily malleable (e.g., highly adaptive)
              and/or subject to relatively strong environmental (nongenetic)
              effects or high levels of measurement error. Irrespective of
              sample size, most traits (but not body size, on average) showed
              less signal than expected given the topology, branch lengths, and
              a Brownian motion model of evolution (i.e., K was less than one),
              which may be attributed to adaptation and/or measurement error in
              the broad sense (including errors in estimates of phenotypes,
              branch lengths, and topology). Analysis of variance of log K for
              all 121 traits (from 35 trees) indicated that behavioral traits
              exhibit lower signal than body size, morphological, life-history,
              or physiological traits. In addition, physiological traits
              (corrected for body size) showed less signal than did body size
              itself. For trees with 20 or more species, the estimated OU (25\%
              of traits) and/or ACDC (40\%) transformation parameter differed
              significantly from both zero and unity, indicating that a
              hierarchical tree with less (or occasionally more) structure than
              the original better fit the data and so could be preferred for
              comparative analyses.",
  journal  = "Evolution",
  volume   =  57,
  number   =  4,
  pages    = "717--745",
  month    =  apr,
  year     =  2003,
  keywords = "pcmBook;NRT-CTN;Rbook",
  language = "en"
}

@ARTICLE{Revell2008-vu,
  title    = "Phylogenetic signal, evolutionary process, and rate",
  author   = "Revell, Liam J and Harmon, Luke J and Collar, David C",
  journal  = "Syst. Biol.",
  volume   =  57,
  number   =  4,
  pages    = "591--601",
  year     =  2008,
  keywords = "citations.txt;pcmBook;NRT-CTN;Rbook"
}

@ARTICLE{OMeara2006-cq,
  title    = "Testing for different rates of continuous trait evolution using
              likelihood",
  author   = "O'Meara, Brian C and An{\'e}, C{\'e}cile and Sanderson, Michael J
              and Wainwright, Peter C",
  abstract = "Rates of phenotypic evolution have changed throughout the history
              of life, producing variation in levels of morphological,
              functional, and ecological diversity among groups. Testing for
              the presence of these rate shifts is a key component of
              evaluating hypotheses about what causes them. In this paper,
              general predictions regarding changes in phenotypic diversity as
              a function of evolutionary history and rates are developed, and
              tests are derived to evaluate rate changes. Simulations show that
              these tests are more powerful than existing tests using
              standardized contrasts. The new approaches are distributed in an
              application called Brownie and in r8s.",
  journal  = "Evolution",
  volume   =  60,
  number   =  5,
  pages    = "922--933",
  month    =  may,
  year     =  2006,
  keywords = "pcmBook;NRT-CTN;Rbook",
  language = "en"
}

@ARTICLE{Revell2012-vj,
  title    = "A new phylogenetic method for identifying exceptional phenotypic
              diversification",
  author   = "Revell, Liam J and Mahler, D Luke and Peres-Neto, Pedro R and
              Redelings, Benjamin D",
  abstract = "Currently available phylogenetic methods for studying the rate of
              evolution in a continuously valued character assume that the rate
              is constant throughout the tree or that it changes along specific
              branches according to an a priori hypothesis of rate variation
              provided by the user. Herein, we describe a new method for
              studying evolutionary rate variation in continuously valued
              characters given an estimate of the phylogenetic history of the
              species in our study. According to this method, we propose no
              specific prior hypothesis for how the variation in evolutionary
              rate is structured throughout the history of the species in our
              study. Instead, we use a bayesian Markov Chain Monte Carlo
              approach to estimate evolutionary rates and the shift point
              between rates on the tree. We do this by simultaneously sampling
              rates and shift points in proportion to their posterior
              probability, and then collapsing the posterior sample into an
              estimate of the parameters of interest. We use simulation to show
              that the method is quite successful at identifying the
              phylogenetic position of a shift in the rate of evolution, and
              that estimated rates are asymptotically unbiased. We also provide
              an empirical example of the method using data for Anolis lizards.",
  journal  = "Evolution",
  volume   =  66,
  number   =  1,
  pages    = "135--146",
  month    =  jan,
  year     =  2012,
  keywords = "Rbook",
  language = "en"
}

@ARTICLE{Revell2018-kr,
  title     = "Comparing evolutionary rates between trees, clades and traits",
  author    = "Revell, Liam J and Gonzalez-Valenzuela, Laura E and Alfonso,
               Alejandro and Castellanos-Garcia, Luisa A and Guarnizo, Carlos E
               and Crawford, Andrew J",
  abstract  = "Abstract The tempo of evolutionary change through time is among
               the most heavily studied dimensions of macroevolution using
               phylogenies. Here, we present a simple, likelihood-based method
               for comparing the rate of phenotypic evolution for continuous
               characters between trees. Our method is derived from a previous
               approach published by Brian O'Meara and colleagues in 2006. We
               examine the statistical performance of the method and find that
               it suffers from the typical downward bias expected for maximum
               likelihood estimates of the variance, but only for very small
               trees. We find that evolutionary rates are estimated with
               minimal bias for trees of even relatively modest size. We also
               find that type I error rates based on a likelihood-ratio test
               are minimally elevated above the nominal level, even for small
               phylogenies. The type I error rate can be reduced to a level at
               or below its nominal value by substituting a test-statistic
               distribution obtained via simulation under the null hypothesis
               of no difference in evolutionary rate among trees. We discuss
               the consequences of failing to account for uncertainty in the
               estimation of species means or in the phylogeny, and describe
               strategies for taking this uncertainty into consideration during
               estimation. We also identify how our approach is related to
               previous methods for comparing the rate of evolution among
               different clades of a single tree or between different
               phenotypic traits. Finally, we describe how the method can be
               applied to different evolutionary models and to discrete
               characters?options that are already implemented in software.
               Evolutionary biologists continue to be intrigued by changes in
               the tempo of phenotypic evolution across the tree of life. The
               method described herein should be useful for contexts in which
               changes in the evolutionary rate or process between two or more
               clades of distant or unknown relationship are of interest.",
  journal   = "Methods Ecol. Evol.",
  publisher = "Wiley Online Library",
  volume    =  9,
  number    =  4,
  pages     = "994--1005",
  month     =  apr,
  year      =  2018,
  keywords  = "Rbook"
}

@article{Revell2021,
  doi = {10.7717/peerj.11997},
  url = {https://doi.org/10.7717/peerj.11997},
  year = {2021},
  month = aug,
  publisher = {{PeerJ}},
  volume = {9},
  pages = {e11997},
  author = {Liam J. Revell},
  title = {A variable-rate quantitative trait evolution model using penalized-likelihood},
  journal = {{PeerJ}}
}

@ARTICLE{Revell2008-uy,
  title     = "{PCCA}: a program for phylogenetic canonical correlation
               analysis",
  author    = "Revell, Liam J and Harrison, Alexis S",
  abstract  = "UNLABELLED: PCCA (phylogenetic canonical correlation analysis)
               is a new program for canonical correlation analysis of
               multivariate, continuously valued data from biological species.
               Canonical correlation analysis is a technique in which derived
               variables are obtained from two sets of original variables
               whereby the correlations between corresponding derived variables
               are maximized. It is a very useful multivariate statistical
               method for the calculation and analysis of correlations between
               character sets. The program controls for species
               non-independence due to phylogenetic history and computes
               canonical coefficients, correlations and scores; and conducts
               hypothesis tests on the canonical correlations. It can also
               compute a multivariate version of Pagel's lambda, which can then
               be used in the phylogenetic transformation. AVAILABILITY: PCCA
               is distributed as DOS/Windows, Mac OS X and Linux/Unix
               executables with a detailed program manual and is freely
               available on the World Wide Web at:
               http://anolis.oeb.harvard.edu/~liam/programs/.",
  journal   = "Bioinformatics",
  publisher = "Oxford University Press (OUP)",
  volume    =  24,
  number    =  7,
  pages     = "1018--1020",
  month     =  apr,
  year      =  2008,
  language  = "en"
}

@ARTICLE{Revell2009-vv,
  title     = "Size-correction and principal components for interspecific
               comparative studies",
  author    = "Revell, Liam J",
  journal   = "Evolution",
  publisher = "Wiley Online Library",
  volume    =  63,
  number    =  12,
  pages     = "3258--3268",
  year      =  2009,
  keywords  = "Rbook"
}

@ARTICLE{Schluter1997-vw,
  title     = "Likelihood of ancestor states in adaptive radiation",
  author    = "Schluter, Dolph and Price, Trevor and Mooers, Arne {\O} and
               Ludwig, Donald",
  abstract  = "Theories of ecological diversification make predictions about
               the timing and ordering of character state changes through
               history. These theories are testable by ``reconstructing''
               ancestor states using phylogenetic trees and measurements of
               contemporary species. Here we use maximum likelihood to estimate
               and evaluate the accuracy of ancestor reconstructions. We
               present likelihoods of discrete ancestor states and derive
               probability distributions for continuous ancestral traits. The
               methods are applied to several examples: diets of ancestral
               Darwin's finches; origin of inquilinism in gall wasps;
               microhabitat partitioning and body size evolution in scrubwrens;
               digestive enzyme evolution in artiodactyl mammals; origin of a
               sexually selected male trait, the sword, in platies and
               swordtails; and evolution of specialization in Anolis lizards.
               When changes between discrete character states are rare, the
               maximum-likelihood results are similar to parsimony estimates.
               In this case the accuracy of estimates is often high, with the
               exception of some nodes deep in the tree. If change is frequent
               then reconstructions are highly uncertain, especially of distant
               ancestors. Ancestor states for continuous traits are typically
               highly uncertain. We conclude that measures of uncertainty are
               useful and should always be provided, despite simplistic
               assumptions about the probabilistic models that underlie them.
               If uncertainty is too high, reconstruction should be abandoned
               in favor of approaches that fit different models of trait
               evolution to species data and phylogenetic trees, taking into
               account the range of ancestor states permitted by the data.",
  journal   = "Evolution",
  publisher = "Wiley",
  volume    =  51,
  number    =  6,
  pages     = "1699--1711",
  month     =  dec,
  year      =  1997,
  keywords  = "Adaptive radiation; ancestor states; evolution of
               specialization; maximum likelihood; phylogeny",
  copyright = "http://onlinelibrary.wiley.com/termsAndConditions",
  language  = "en"
}

@INCOLLECTION{Felsenstein2002,
  title     = "Graphical Methods for Visualizing Comparative Data on
               Phylogenies",
  booktitle = "Morphology, Shape and Phylogeny",
  author    = "Felsenstein, Joseph",
  editor    = "MacLeod, N. and Forey, P.",
  publisher = "Taylor and Francis",
  pages     = "27--44",
  year      =  2002,
  address   = "London, UK"
 }

@ARTICLE{Revell2015-il,
  title     = "Placing cryptic, recently extinct, or hypothesized taxa into an
               ultrametric phylogeny using continuous character data: a case
               study with the lizard Anolis roosevelti",
  author    = "Revell, Liam J and Mahler, D Luke and Reynolds, R Graham and
               Slater, Graham J",
  abstract  = "In recent years, enormous effort and investment has been put
               into assembling the tree of life: a phylogenetic history for all
               species on Earth. Overwhelmingly, this progress toward building
               an ever increasingly complete phylogeny of living things has
               been accomplished through sophisticated analysis of molecular
               data. In the modern genomic age, molecular genetic data have
               become very easy and inexpensive to obtain for many species.
               However, some lineages are poorly represented in or absent from
               tissue collections, or are unavailable for molecular analysis
               for other reasons such as restrictive biological sample export
               laws. Other species went extinct recently and are only available
               in formalin museum preparations or perhaps even as subfossils.
               In this brief communication we present a new method for placing
               cryptic, recently extinct, or hypothesized taxa into an
               ultrametric phylogeny of extant taxa using continuous character
               data. This method is based on a relatively simple modification
               of an established maximum likelihood (ML) method for phylogeny
               inference from continuous traits. We show that the method works
               well on simulated trees and data. We then apply it to the case
               of placing the Culebra Island Giant Anole (Anolis roosevelti)
               into a phylogeny of Caribbean anoles. Anolis roosevelti is a
               ``crown-giant'' ecomorph anole hypothesized to have once been
               found throughout the Spanish, United States, and British Virgin
               Islands, but that has not been encountered or collected since
               the 1930s. Although this species is widely thought to be closely
               related to the Puerto Rican giant anole, A. cuvieri, our ML
               method actually places A. roosevelti in a different part of the
               tree and closely related to a clade of morphologically similar
               species. We are unable, however, to reject a phylogenetic
               position for A. roosevelti that places it as sister taxon to A.
               cuvieri; although close relationship with the remainder of
               Puerto Rican anole species is strongly rejected by our method.",
  journal   = "Evolution",
  publisher = "Wiley",
  volume    =  69,
  number    =  4,
  pages     = "1027--1035",
  month     =  apr,
  year      =  2015,
  keywords  = "Fossils; phylogenetic inference; quantitative characters;
               time-calibrated tree",
  language  = "en"
}

@ARTICLE{Collar2014-sw,
  title     = "Biting disrupts integration to spur skull evolution in eels",
  author    = "Collar, D C and Wainwright, P C and Alfaro, M E and Revell, L J
               and Mehta, R S",
  abstract  = "The demand that anatomical structures work together to perform
               biological functions is thought to impose strong limits on
               morphological evolution. Breakthroughs in diversification can
               occur, however, when functional integration among structures is
               relaxed. Although such …",
  journal   = "Nature",
  publisher = "nature.com",
  year      =  2014,
  keywords  = "Rbook"
}

@article{Broeckhoven2016,
  doi = {10.1111/evo.13062},
  url = {https://doi.org/10.1111/evo.13062},
  year = {2016},
  month = sep,
  publisher = {Wiley},
  volume = {70},
  number = {11},
  pages = {2647--2656},
  author = {Chris Broeckhoven and Genevieve Diedericks and Cang Hui and Buyisile G. Makhubo and P. le Fras N. Mouton},
  title = {Enemy at the gates: Rapid defensive trait diversification in an adaptive radiation of lizards},
  journal = {Evolution}
}

@ARTICLE{Revell2022-tr,
  title     = "A simple hierarchical model for heterogeneity in the
               evolutionary correlation on a phylogenetic tree",
  author    = "Revell, Liam J and Toyama, Ken S and Mahler, D Luke",
  abstract  = "Numerous questions in phylogenetic comparative biology revolve
               around the correlated evolution of two or more phenotypic traits
               on a phylogeny. In many cases, it may be sufficient to assume a
               constant value for the evolutionary correlation between
               characters across all the clades and branches of the tree. Under
               other circumstances, however, it is desirable or necessary to
               account for the possibility that the evolutionary correlation
               differs through time or in different sections of the phylogeny.
               Here, we present a method designed to fit a hierarchical series
               of models for heterogeneity in the evolutionary rates and
               correlation of two quantitative traits on a phylogenetic tree.
               We apply the method to two datasets: one for different
               attributes of the buccal morphology in sunfishes
               (Centrarchidae); and a second for overall body length and
               relative body depth in rock- and non-rock-dwelling South
               American iguanian lizards. We also examine the performance of
               the method for parameter estimation and model selection using a
               small set of numerical simulations.",
  journal   = "PeerJ",
  publisher = "PeerJ",
  volume    =  10,
  number    = "e13910",
  pages     = "e13910",
  month     =  aug,
  year      =  2022,
  keywords  = "Comparative methods; Model fitting; Phylogeny",
  language  = "en"
}
